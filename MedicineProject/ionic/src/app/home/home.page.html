<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>
      Patient Recipes
    </ion-title>
    <ion-buttons slot="secondary">
      {{userName}}
      <ion-button routerLink="/login" routerDirection="root">
        <ion-icon slot="icon-only" name="log-out"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-list>
    <ion-list-header>
      <ion-label>
        Patients
      </ion-label>
      <ion-button shape="round" fill="outline" color="success" (click)="add()">
        <ion-icon slot="start" name="add">
        </ion-icon>Add
      </ion-button>
    </ion-list-header>

    <app-patient *ngIf="showNew" 
        [isNew]="true" 
        (addPatient)="addPatient($event)"
        (cancelAddingPatient)="showNew=false">
    
    </app-patient>


  <div *ngFor="let patient of patients;let i = index">
        <ion-item-sliding>
          <ion-item-options side="start">
            <ion-item-option color="primary" (click)="showEdit=i">
              <ion-icon name="create"></ion-icon>Change
            </ion-item-option>

            <ion-item-option color="danger" (click)="delete(patient)">
              <ion-icon name="trash"></ion-icon>Delete
            </ion-item-option>

          
          </ion-item-options>

          <ion-item (click)="showEdit=-1">
            <ion-icon name="logo-github" slot="start"></ion-icon>
            <ion-label>{{patient.fullname}}</ion-label>
            <ion-note slot="end">Recipes: {{patient.recipes_quantity}}</ion-note>
          </ion-item>
          
          <ion-item-options>
            <ion-item-option side="end" color="secondary" 
            routerLink="/recipes/{{patient.id}}"
            routerDirection="forward">
              <ion-icon name="list"></ion-icon>List
             </ion-item-option>
          </ion-item-options>
          
        </ion-item-sliding>


        <app-patient *ngIf="showEdit==i" 
          [isNew]="false" 
          [patient]="patient">
        </app-patient>

        
        <ion-refresher slot="fixed" snapback-duration="200ms" pullFactor="0.5" pullMin="35" pullMax="200" (ionRefresh)="refresh($event)">
          <ion-refresher-content
          pullingIcon="chevron-down-circle-outline"
          pullingText="Pull to refresh"
          refreshingSpinner="circles"
          refreshingText="Refreshing...">

          </ion-refresher-content>
        </ion-refresher>

        
  </div>
</ion-list>
</ion-content>
